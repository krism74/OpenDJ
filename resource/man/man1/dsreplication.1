'\" t
.\"     Title: dsreplication
.\"    Author: 
.\" Generator: DocBook XSL-NS Stylesheets v1.76.1 <http://docbook.sf.net/>
.\"      Date: 01/17/2014
.\"    Manual: Tools Reference
.\"    Source: OpenDJ 2.7.0-SNAPSHOT
.\"  Language: English
.\"
.TH "DSREPLICATION" "1" "01/17/2014" "OpenDJ 2\&.7\&.0\-SNAPSHOT" "Tools Reference"
.\" -----------------------------------------------------------------
.\" * Define some portability stuff
.\" -----------------------------------------------------------------
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.\" http://bugs.debian.org/507673
.\" http://lists.gnu.org/archive/html/groff/2009-02/msg00013.html
.\" ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
.ie \n(.g .ds Aq \(aq
.el       .ds Aq '
.\" -----------------------------------------------------------------
.\" * set default formatting
.\" -----------------------------------------------------------------
.\" disable hyphenation
.nh
.\" disable justification (adjust text to left margin only)
.ad l
.\" -----------------------------------------------------------------
.\" * MAIN CONTENT STARTS HERE *
.\" -----------------------------------------------------------------
.SH "NAME"
dsreplication \- manage OpenDJ directory data replication
.SH "SYNOPSIS"
.HP \w'\fBdsreplication\fR\fB\fIsubcommand\fR\fR\ 'u
\fBdsreplication\fR\fB\fIsubcommand\fR\fR [options]
.SH "DESCRIPTION"
.PP
This utility can be used to configure replication between servers so that the data of the servers is synchronized\&. For replication to work you must first enable replication using the
\fBenable\fR
subcommand and then initialize the contents of one of the servers with the contents of the other using the
\fBinitialize\fR
subcommand\&.
.SH "GLOBAL OPTIONS"
.PP
The following options are supported\&.
.PP
\fB\-\-advanced\fR
.RS 4
Access advanced settings when running this command in interactive mode\&.
.RE
.PP
\fB\-b, \-\-baseDN {baseDN}\fR
.RS 4
Base DN of the data to be replicated, initialized or for which you want to disable replication\&. Multiple base DNs can be provided by using this option multiple times\&.
.RE
.SS "LDAP Connection Options"
.PP
\fB\-\-connectTimeout {timeout}\fR
.RS 4
Maximum length of time (in milliseconds) that can be taken to establish a connection\&. Use \*(Aq0\*(Aq to specify no time out\&.
.sp
Default value: 30000
.RE
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value: localhost\&.localdomain
.RE
.PP
\fB\-I, \-\-adminUID {adminUID}\fR
.RS 4
User ID of the global administrator to use to bind to the server\&. For the
\fBenable\fR
subcommand, if no global administrator was defined previously for any servers, the global administrator will be created using the UID provided\&.
.sp
Default value: admin
.RE
.PP
\fB\-j, \-\-adminPasswordFile {bindPasswordFile}\fR
.RS 4
Global administrator password file
.RE
.PP
\fB\-K, \-\-keyStorePath {keyStorePath}\fR
.RS 4
Certificate key store path
.RE
.PP
\fB\-N, \-\-certNickname {nickname}\fR
.RS 4
Nickname of certificate for SSL client authentication
.RE
.PP
\fB\-o, \-\-saslOption {name=value}\fR
.RS 4
SASL bind options
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value: 4444
.RE
.PP
\fB\-P, \-\-trustStorePath {trustStorePath}\fR
.RS 4
Certificate trust store path
.sp
Default value: /path/to/opendj/config/admin\-truststore
.RE
.PP
\fB\-T, \-\-trustStorePassword {trustStorePassword}\fR
.RS 4
Certificate trust store PIN
.RE
.PP
\fB\-u, \-\-keyStorePasswordFile {keyStorePasswordFile}\fR
.RS 4
Certificate key store PIN file
.RE
.PP
\fB\-U, \-\-trustStorePasswordFile {path}\fR
.RS 4
Certificate trust store PIN file
.RE
.PP
\fB\-w, \-\-adminPassword {bindPassword}\fR
.RS 4
Password for the global administrator
.RE
.PP
\fB\-W, \-\-keyStorePassword {keyStorePassword}\fR
.RS 4
Certificate key store PIN
.RE
.PP
\fB\-X, \-\-trustAll\fR
.RS 4
Trust all server SSL certificates
.RE
.SS "Utility Input/Output Options"
.PP
\fB\-\-commandFilePath {path}\fR
.RS 4
The full path to the file where the equivalent non\-interactive commands will be written when this command is run in interactive mode\&.
.RE
.PP
\fB\-\-displayCommand\fR
.RS 4
Display the equivalent non\-interactive option on standard output when this command is run in interactive mode\&.
.RE
.PP
\fB\-n, \-\-no\-prompt\fR
.RS 4
Use non\-interactive mode\&. If data in the command is missing, the user is not prompted and the command exits with an error\&.
.RE
.PP
\fB\-\-noPropertiesFile\fR
.RS 4
No properties file will be used to get default command line argument values
.RE
.PP
\fB\-\-propertiesFilePath {propertiesFilePath}\fR
.RS 4
Path to the file containing default property values used for command line arguments
.RE
.PP
\fB\-Q, \-\-quiet\fR
.RS 4
Do not write progress information to standard output
.RE
.SS "General Options"
.PP
\fB\-\-version\fR
.RS 4
Display version information
.RE
.PP
\fB\-?, \-H, \-\-help\fR
.RS 4
Display usage information
.RE
.SH "EXIT CODES"
.PP
0
.RS 4
The command completed successfully\&.
.RE
.PP
> 0
.RS 4
An error occurred\&.
.RE
.SH "SUBCOMMANDS"
.PP
The following subcommands are supported\&.
.PP
\fBdisable\fR
.RS 4
Disable replication on the specified server for the provided base DN and removes references in the other servers with which it is replicating data\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-a, \-\-disableAll\fR
.RS 4
Disable the replication configuration on the specified server\&. The contents of the server are no longer replicated and the replication server (changelog and replication port) is disabled if it is configured\&.
.RE
.PP
\fB\-D, \-\-bindDN {bindDN}\fR
.RS 4
DN to use to bind to the server where we want to disable replication\&. This option must be used when no Global Administrator has been defined on the server or if the user does not want to remove references in the other replicated servers\&. The password provided for the Global Administrator will be used when specifying this option\&.
.sp
Default value: cn=Directory Manager
.RE
.PP
\fB\-\-disableReplicationServer\fR
.RS 4
Disable the replication server\&. The replication port and change log are disabled on the specified server\&.
.RE
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.RE
.PP
\fBenable\fR
.RS 4
Update the configuration of the servers to replicate the data under the specified base DN\&. If one of the specified servers is already replicating the data under the base DN with other servers, executing this subcommand will update the configuration of all the servers\&. Thus it is sufficient to execute the command line once for each server added to the replication topology\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-host1 {host}\fR
.RS 4
Fully qualified host name or IP address of the first server whose contents will be replicated\&.
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port1 {port}\fR
.RS 4
Directory server administration port number of the first server whose contents will be replicated\&.
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.PP
\fB\-D, \-\-bindDN1 {bindDN}\fR
.RS 4
DN to use to bind to the first server whose contents will be replicated\&. If not specified the global administrator will be used to bind\&.
.sp
Default value: cn=Directory Manager
.RE
.PP
\fB\-\-bindPassword1 {bindPassword}\fR
.RS 4
Password to use to bind to the first server whose contents will be replicated\&. If no bind DN was specified for the first server the password of the global administrator will be used to bind\&.
.RE
.PP
\fB\-\-bindPasswordFile1 {bindPasswordFile}\fR
.RS 4
File containing the password to use to bind to the first server whose contents will be replicated\&. If no bind DN was specified for the first server the password of the global administrator will be used to bind\&.
.RE
.PP
\fB\-r, \-\-replicationPort1 {port}\fR
.RS 4
Port that will be used by the replication mechanism in the first server to communicate with the other servers\&. You have to specify this option only if replication was not previously configured in the first server\&.
.sp
Default value: 8989
.RE
.PP
\fB\-\-secureReplication1\fR
.RS 4
Specifies whether or not the communication through the replication port of the first server is encrypted or not\&. This option will only be taken into account the first time replication is configured on the first server\&.
.RE
.PP
\fB\-\-noReplicationServer1\fR
.RS 4
Do not configure a replication port or change log on the first server\&. The first server will contain replicated data but will not contain a change log of modifications made to the replicated data\&. Note that each replicated topology must contain at least two servers with a change log to avoid a single point of failure\&.
.RE
.PP
\fB\-\-onlyReplicationServer1\fR
.RS 4
Configure only a change log and replication port on the first server\&. The first server will not contain replicated data, but will contain a change log of the modifications made to the replicated data on other servers\&.
.RE
.PP
\fB\-O, \-\-host2 {host}\fR
.RS 4
Fully qualified host name or IP address of the second server whose contents will be replicated\&.
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-\-port2 {port}\fR
.RS 4
Directory server administration port number of the second server whose contents will be replicated\&.
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.PP
\fB\-\-bindDN2 {bindDN}\fR
.RS 4
DN to use to bind to the second server whose contents will be replicated\&. If not specified the global administrator will be used to bind\&.
.sp
Default value: cn=Directory Manager
.RE
.PP
\fB\-\-bindPassword2 {bindPassword}\fR
.RS 4
Password to use to bind to the second server whose contents will be replicated\&. If no bind DN was specified for the second server the password of the global administrator will be used to bind\&.
.RE
.PP
\fB\-F, \-\-bindPasswordFile2 {bindPasswordFile}\fR
.RS 4
File containing the password to use to bind to the second server whose contents will be replicated\&. If no bind DN was specified for the second server the password of the global administrator will be used to bind\&.
.RE
.PP
\fB\-R, \-\-replicationPort2 {port}\fR
.RS 4
Port that will be used by the replication mechanism in the second server to communicate with the other servers\&. You have to specify this option only if replication was not previously configured in the second server\&.
.sp
Default value: 8989
.RE
.PP
\fB\-\-secureReplication2\fR
.RS 4
Specifies whether or not the communication through the replication port of the second server is encrypted or not\&. This option will only be taken into account the first time replication is configured on the second server\&.
.RE
.PP
\fB\-\-noReplicationServer2\fR
.RS 4
Do not configure a replication port or change log on the second server\&. The second server will contain replicated data but will not contain a change log of modifications made to the replicated data\&. Note that each replicated topology must contain at least two servers with a change log to avoid a single point of failure\&.
.RE
.PP
\fB\-\-onlyReplicationServer2\fR
.RS 4
Configure only a change log and replication port on the second server\&. The second server will not contain replicated data, but will contain a change log of the modifications made to the replicated data on other servers\&.
.RE
.PP
\fB\-S, \-\-skipPortCheck\fR
.RS 4
Skip the check to determine whether the specified replication ports are usable\&.
.RE
.PP
\fB\-\-noSchemaReplication\fR
.RS 4
Do not replicate the schema between the servers\&.
.RE
.PP
\fB\-\-useSecondServerAsSchemaSource\fR
.RS 4
Use the second server to initialize the schema of the first server\&. If this option nor option \-\-noSchemaReplication are specified the schema of the first server will be used to initialize the schema of the second server\&.
.RE
.RE
.PP
\fBinitialize\fR
.RS 4
Initialize the contents of the data under the specified base DN on the destination server with the contents on the source server\&. This operation is required after enabling replication in order replication to work\&.
\fBinitialize\-all\fR
can also be used for this purpose\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-hostSource {host}\fR
.RS 4
Fully qualified host name or IP address of the source server whose contents will be used to initialize the destination server\&.
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-portSource {port}\fR
.RS 4
Directory server administration port number of the source server whose contents will be used to initialize the destination server\&.
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.PP
\fB\-O, \-\-hostDestination {host}\fR
.RS 4
Fully qualified host name or IP address of the destination server whose contents will be initialized\&.
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-\-portDestination {port}\fR
.RS 4
Directory server administration port number of the destination server whose contents will be initialized\&.
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.RE
.PP
\fBinitialize\-all\fR
.RS 4
Initialize the contents of the data under the specified base DN on all the servers whose contents are being replicated with the contents on the specified server\&. This operation is required after enabling replication for replication to work\&. Run
\fBinitialize\fR
for each server to achieve the same effect\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.RE
.PP
\fBpost\-external\-initialization\fR
.RS 4
This subcommand must be called after initializing the contents of all the replicated servers using the
\fBimport\-ldif\fR
command, or by copying the database\&. You must specify the list of base DNs that have been initialized, and you must provide the credentials of any of the servers that are being replicated\&. See
\fBpre\-external\-initialization \-\-help\fR
for more information\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.RE
.PP
\fBpre\-external\-initialization\fR
.RS 4
This subcommand must be called before initializing the contents of all the replicated servers using the
\fBimport\-ldif\fR
command, or by copying the database\&. You must specify the list of base DNs that have been initialized, and you must provide the credentials of any of the servers that are being replicated\&. After calling this subcommand, initialize the contents of all the servers in the topology, either by using the same LDIF file or by copying the database to each of the servers, then call the
\fBpost\-external\-initialization\fR
subcommand\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.RE
.PP
\fBpurge\-historical\fR
.RS 4
Launch a purge processing of the historical information stored in the user entries by replication\&. Since this processing may take a while, you must specify a maximum duration\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.PP
\fB\-\-maximumDuration {maximum duration}\fR
.RS 4
This argument specifies the maximum duration the purge processing must last expressed in seconds\&.
.sp
Default value: 3600
.RE
.PP
\fB\-t, \-\-start {startTime}\fR
.RS 4
Indicates the date/time at which this operation will start when scheduled as a server task expressed in YYYYMMDDhhmmssZ format for UTC time or YYYYMMDDhhmmss for local time\&. A value of \*(Aq0\*(Aq will cause the task to be scheduled for immediate execution\&. When this option is specified the operation will be scheduled to start at the specified time after which this utility will exit immediately\&.
.RE
.PP
\fB\-\-recurringTask {schedulePattern}\fR
.RS 4
Indicates the task is recurring and will be scheduled according to the value argument expressed in crontab(5) compatible time/date pattern
.RE
.PP
\fB\-\-completionNotify {emailAddress}\fR
.RS 4
Email address of a recipient to be notified when the task completes\&. This option may be specified more than once\&.
.RE
.PP
\fB\-\-errorNotify {emailAddress}\fR
.RS 4
Email address of a recipient to be notified if an error occurs when this task executes\&. This option may be specified more than once\&.
.RE
.PP
\fB\-\-dependency {taskID}\fR
.RS 4
ID of a task upon which this task depends\&. A task will not start execution until all its dependencies have completed execution\&.
.RE
.PP
\fB\-\-failedDependencyAction {action}\fR
.RS 4
Action this task will take should one if its dependent tasks fail\&. The value must be one of PROCESS,CANCEL,DISABLE\&. If not specified defaults to CANCEL\&.
.RE
.RE
.PP
\fBstatus\fR
.RS 4
Display a list with the basic replication configuration of the base DNs of the servers defined in the registration information\&. If no base DNs are specified as parameter, information for all base DNs is displayed\&.
In addition to global options, these subcommand options are supported\&.
.PP
\fB\-h, \-\-hostname {host}\fR
.RS 4
Directory server hostname or IP address
.sp
Default value:
\fIconfigured\-hostname\fR
.RE
.PP
\fB\-p, \-\-port {port}\fR
.RS 4
Directory server administration port number
.sp
Default value:
\fIconfigured\-admin\-port\fR
.RE
.PP
\fB\-s, \-\-script\-friendly\fR
.RS 4
Use script\-friendly mode\&.
.RE
.RE
.SH "EXAMPLES"
.PP
The following example enables and then initializes replication for a new replica on
opendj2\&.example\&.com
from an existing replica on
opendj\&.example\&.com\&.
.sp
.if n \{\
.RS 4
.\}
.nf
$ dsreplication enable \-I admin \-w password \-X \-n \-b dc=example,dc=com
 \-\-host1 opendj\&.example\&.com \-\-port1 4444 \-\-bindDN1 "cn=Directory Manager"
 \-\-bindPassword1 password \-\-replicationPort1 8989
 \-\-host2 opendj2\&.example\&.com \-\-port2 4444 \-\-bindDN2 "cn=Directory Manager"
 \-\-bindPassword2 password \-\-replicationPort2 8989

Establishing connections \&.\&.\&.\&.\&. Done\&.
Checking registration information \&.\&.\&.\&.\&. Done\&.
Updating remote references on server opendj\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Configuring Replication port on server opendj2\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Updating replication configuration for baseDN dc=example,dc=com on server
 opendj\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Updating replication configuration for baseDN dc=example,dc=com on server
 opendj2\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Updating registration configuration on server
 opendj\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Updating registration configuration on server
 opendj2\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Updating replication configuration for baseDN cn=schema on server
 opendj\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Updating replication configuration for baseDN cn=schema on server
 opendj2\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Initializing registration information on server opendj2\&.example\&.com:4444 with
 the contents of server opendj\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.
Initializing schema on server opendj2\&.example\&.com:4444 with the contents of
 server opendj\&.example\&.com:4444 \&.\&.\&.\&.\&. Done\&.

Replication has been successfully enabled\&.  Note that for replication to
 work you must initialize the contents of the base DN\*(Aqs that are being
  replicated (use dsreplication initialize to do so)\&.

See
/var/\&.\&.\&./opends\-replication\-7958637258600693490\&.log
for a detailed log of this operation\&.
$ dsreplication initialize\-all \-I admin \-w password \-X \-n \-b dc=example,dc=com
 \-h opendj\&.example\&.com \-p 4444

Initializing base DN dc=example,dc=com with the contents from
 opendj\&.example\&.com:4444: 160 entries processed (100 % complete)\&.
Base DN initialized successfully\&.

See
/var/\&.\&.\&./opends\-replication\-5020375834904394170\&.log
for a detailed log of this operation\&.
.fi
.if n \{\
.RE
.\}
.SH "COPYRIGHT"
.br
Copyright \(co 2011-2014 ForgeRock AS
.br
